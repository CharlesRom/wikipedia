define(["modules/default/defaultview","src/util/util","src/util/api","lib/loadingplot/loadingplot","components/jquery-mousewheel/jquery.mousewheel.min"],function(a,b,c,d){function e(){}return b.loadCss("lib/loadingplot/svg.css"),e.prototype=$.extend(!0,{},a,{init:function(){this.dom=$('<div class="ci-display-loading-plot"></div>'),this.module.getDomContent().html(this.dom),this.resolveReady()},onResize:function(a,b){this._w=a-10,this._h=b-10,this._w&&this._h&&this._svg&&this._svg.setSize(this._w,this._h)},blank:{loading:function(){this.dom&&this.dom.empty(),c.killHighlight(this.module.getId())}},update:{preferences:function(a){if(this._lastConf=a,this._lastValue)for(var b in a)for(var c=0;c<this._lastValue.series.length;c++)if(this._lastValue.series[c].category==b)for(var d=0;d<this._lastValue.series[c].data.length;d++)this._instances[c][d].filter(a[b])},center:function(a){a&&this._svg.setCenter.apply(this._svg,a)},zoom:function(a){console.log(a),a&&this._svg.setZoom(a)},viewport:function(a){a&&this._svg.setViewBox.apply(this._svg,[!1].concat(a))},loading:function(a){var b=this;if(a&&a.value){this._highlights=[];var e=new d.SVG(null,null,null,null,this.module.getConfiguration("navigation")[0][0]||!1);e.onZoomChange(function(a){b.module.controller.onZoomChange(a),b.module.controller.onChangeViewport(e.getViewBox())}),e.onMove(function(a,c){b.module.controller.onMove(a,c),b.module.controller.onChangeViewport(e.getViewBox())}),this._svg=e,this._w&&this._h&&e.setSize(this._w,this._h);var f=a.value.minX||0,g=a.value.minY||0,h=(a.value.maxX||100)-f,i=(a.value.maxY||100)-g;e.setViewBoxWidth(f,g,h,i,!0),e.create(),e.bindTo(this.dom);var j=new d.SpringLabels(e);if(e.initZoom(),d.SVGElement.prototype.Springs=j,this._lastValue=a.value,this._instances=[],a.value&&a.value.series){for(var k=this.module.getConfiguration("layers"),l=0;l<k.length;l++){var m,n=k[l].groups.group[0],o=n.labels[0],p={};for(m=0;m<o.length;m++)p[o[m]]=!0;var q=n.el[0],r=n.type[0]||"ellipse";for(m=0;m<a.value.series.length;m++)if(a.value.series[m].category===q){for(var s,t=a.value.series[m].data,u=0,v=t.length;v>u;u++){"pie"===r?s=new d.Pie(e,t[u].x,t[u].y,t[u]):"ellipse"===r?s=new d.Ellipse(e,t[u].x,t[u].y,t[u]):"img"===r&&(s=new d.Image(e,t[u].x,t[u].y,t[u])),s.allowLabelDisplay(p.display_labels),n.labelsize[0]&&s.setLabelSize(n.labelsize[0]),s.forceField(p.forcefield),""!==n.labelzoomthreshold[0]&&s.setLabelDisplayThreshold(n.labelzoomthreshold[0]);var w=n.highlightmag[0]?n.highlightmag[0]:1,x=n.highlighteffect[0][0]?!0:!1;s.setHighlightMag(w),s.setHighlightEffect({mag:w,yStroke:x}),s.setLabelStroke(p.blackstroke),s.setLabelScale(p.scalelabel);var y=s.highlight.bind(s);c.listenHighlight(t[u],y,!1,this.module.getId()),s.hoverCallback=function(){b.module.controller.hover(this._data)},this._instances[m]=this._instances[m]||[],this._instances[m][u]=s,e.add(s)}break}}e.ready(),j.resolve(),this._lastConf&&this.update.preferences.call(this,this._lastConf)}}}}}),e});