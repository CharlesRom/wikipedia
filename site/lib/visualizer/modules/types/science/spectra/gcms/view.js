define(["modules/default/defaultview","src/util/datatraversing","lib/gcms/gcms","src/util/util","src/util/api"],function(a,b,c,d,e){function f(){}return f.prototype=$.extend(!0,{},a,{init:function(){this.namedSeries={};var a=document.createElement("div"),b=document.createElement("div"),c=document.createElement("div");c.appendChild(a),c.appendChild(b),b.style.width="100%",b.style.height="100px",a.style.width="100%",a.style.height="250px",this.div1=a,this.div2=b,this.dom=c,this.module.getDomContent().html(c),this.resolveReady()},unload:function(){this.dom.remove()},inDom:function(){var a=this,b=new c(this.div1,this.div2,{AUCCreated:function(a){Math.round(a.data.pos.x),Math.round(a.data.pos2.x)},AUCChange:function(a){var b=Math.round(a.data.pos.x),c=Math.round(a.data.pos2.x);a.msFromAucSerie&&(a.msFromAucSerie.setLineColor("rgba(255, 0, 0, 1)"),a.msFromAucSerie.applyLineStyles()),a.data._originalSource&&(a.data._originalSource.set("from",b),a.data._originalSource.set("to",c),a.data._originalSource.triggerChange())},onMsFromAUCChange:function(b){a.module.controller.createDataFromEvent("onMSChange","ms",b)},AUCSelected:function(b){b.data&&(a.module.controller.createDataFromEvent("onIntegralSelect","GCIntegration",b.data._originalSource),a.module.controller.sendAction("GCIntegration",b.data._originalSource,"onIntegralSelect"))},AUCUnselected:function(a){var b=a.data.color;a.set("fillColor","rgba("+b[0]+", "+b[1]+", "+b[2]+", 0.3)"),a.set("strokeColor","rgba("+b[0]+", "+b[1]+", "+b[2]+", 1)"),a.setFillColor(),a.setStrokeColor(),a.msFromAucSerie&&(a.msFromAucSerie.setLineColor("rgba("+b[0]+", "+b[1]+", "+b[2]+", 0.3)"),a.msFromAucSerie.applyLineStyles(),a.msFromAucSerie.hidePeakPicking(!0))},AUCRemoved:function(a){a.msFromAucSerie&&a.msFromAucSerie.kill()},MZChange:function(b){a.module.controller.sendAction("mzList",b,"onMZSelectionChange")},MSChangeIndex:function(b,c){a.module.controller.sendAction("msIndex",b,"onMSIndexChanged"),a.module.controller.createDataFromEvent("onMSIndexChanged","msMouse",c)},onZoomGC:function(b,c){a.module.controller.sendAction("fromtoGC",[b,c],"onZoomGCChange"),a.module.controller.sendAction("centerGC",(c+b)/2,"onZoomGCChange")},ingredientSelected:function(b){a.module.controller.sendAction("selectedIngredient",b,"onIngredientSelected")},onlyOneMS:!0});this.gcmsInstance=b},unload:function(){this.dom.remove()},onResize:function(){this.gcmsInstance.resize(this.width,this.height)},blank:{jcamp:function(){}},update:{jcamp:function(a){var b=this;a&&(a=a.get(),require(["components/jcampconverter/build/jcampconverter"],function(c){c.convert(a,!0).then(function(a){a.gcms&&(b.gcmsInstance.setGC(a.gcms.gc),b.gcmsInstance.setMS(a.gcms.ms),b.module.controller.createDataFromEvent("onJCampParsed","msdata",a.gcms.ms),b.module.controller.createDataFromEvent("onJCampParsed","gcdata",a.gcms.gc),b.jcamp=a)})}))},annotationgc:function(a){a&&(this.resetAnnotationsGC(),this.addAnnotations(a))},gcms:function(a){this.gcmsInstance.setGC(a.gc),this.gcmsInstance.setMS(a.ms)},gc:function(a){var b=this;if(this.gcmsInstance&&a){tojcamp(a.get()).done(function(a){a.spectra&&b.gcmsInstance.setExternalGC(a.spectra[0].data[0])})}},ms:function(a){this.gcmsInstance&&a&&this.gcmsInstance.setExternalMS(a,{})},mscont:function(a,b){this.update.ms(a,b,!0)},ingredientList:function(a){var b=this;a&&(this.ingredientList=a,this.ingredientList.map(function(a){b.gcmsInstance.addIngredient(a)}))},RIComponents:function(a){a&&this.gcmsInstance.setRIComponents(a)}},getDom:function(){return this.dom},resetAnnotationsGC:function(){this.gcmsInstance&&this.gcmsInstance.killAllAUC()},addAnnotations:function(a){var b=this;a.map(function(a){var c=b.gcmsInstance.addAUC(a.from,a.to,a);c._originalSource=a}),this.annotations=a},onActionReceive:{fromtoGC:function(a){a=a.get();var b=a.from-.1*Math.abs(a.to-a.from),c=a.to+.1*Math.abs(a.to-a.from);this.gcmsInstance.getGC().getBottomAxis()._doZoomVal(b,c,!0),this.gcmsInstance.getGC().redraw(!0,!0,!1),this.gcmsInstance.getGC().drawSeries(),this.module.controller.sendAction("centerGC",(c+b)/2,"onZoomGCChange"),this.gcmsInstance.updateIngredientPeaks()},fromtoMS:function(a){this.gcmsInstance.getMS().getBottomAxis()._doZoomVal(a.from,a.to,!0)},externalMS:function(a){var b=this;this.gcmsInstance&&a&&(this.gcmsInstance.setExternalMS(a,{}),b.module.controller.createDataFromEvent("onMSChange","ms",a))},zoomOnAnnotation:function(a){(a.pos||a.pos2)&&(this.gcmsInstance.zoomOn(a.pos.x,a.pos2.x,a._max||!1),this.module.controller.sendAction("centerGC",(a.pos.x+a.pos2.x)/2,"onZoomGCChange"),this.gcmsInstance.updateIngredientPeaks())},displayChemicalLabels:function(){return},hideChemicalLabels:function(){return},centerGC:function(a){var b=this.gcmsInstance.getGC().getBottomAxis(),c=b.getActualMin(),d=b.getActualMax(),e=Math.abs(d-c)/2;b._doZoomVal(a-e,a+e,!0),this.gcmsInstance.getGC().redraw(!0,!0,!1),this.gcmsInstance.getGC().drawSeries()},setMSIndexData:function(a){this.gcmsInstance.setMSIndexData(a)}},doAnnotation:function(a){return}}),f});