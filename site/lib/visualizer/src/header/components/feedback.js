define(["jquery","src/util/ui","src/header/components/default","./couchshare/share","forms/button","src/util/util"],function(a,b,c,d,e,f){function g(){}var h={couchUrl:"http://visualizer.epfl.ch",database:"x",tinyUrl:"http://visualizer.epfl.ch/tiny"};return f.inherits(g,c,{initImpl:function(){this.dialogOptions={title:"Feedback",width:900,height:350}},_onClick:function(){var c=f.getNextUniqueId(),g=a("<span>").attr("id",c+"-message").css("color","red"),i=a("<div>").html('<h2>Do you have a comment on the visualizer ? Did you find a bug ?</h2><p>Put your comment here and we will be notified.<br>A snapshot of you view and data will also be sent to us so feel free to describe exactly what you did and what happened !</p><table><tr><td>Title : </td><td><input type="text" id="'+c+'-title" style="width:500px" /></td></tr><tr><td>Description : </td><td><textarea id="'+c+'-description" rows="12" cols="80"></textarea></td></tr></table>').append(new e("Send",function(){var b=this;this.options.disabled||d.share(h).done(function(d){var e=a("#"+c+"-title").val(),f=a("#"+c+"-description").val(),h={title:e,body:f+"\n\nTestcase: "+d+" ([Original URL]("+document.location.href+"))"};a.ajax({type:"POST",url:"http://visualizer.epfl.ch/github/api/issue",contentType:"application/json",dataType:"json",data:JSON.stringify(h),success:function(a){console.log("success",a),g.html('Thank you for your feedback ! You can follow your issue <a target="_blank" href="'+a.description+'">here</a>'),b.disable()},error:function(a){g.html("ERROR"),console.log("error",a)}})}).fail(function(a){g.html("ERROR"),console.log("error",a)})},{color:"blue"}).render()).append(g);b.dialog(i,this.dialogOptions)}}),g});