define(function(){function a(){var a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a),this._win=a.contentWindow;var c=this._win;this._frame=a,this._originalKeys=Object.keys(c),Object.defineProperty(c,"parent",{value:null}),b.forEach(function(a){Object.defineProperty(c,a,{value:window[a]})}),this._closed=!1}var b=["DataObject","DataArray","DataString","DataBoolean","DataNumber","Promise","require"];return a.prototype.close=function(){document.body.removeChild(this._frame),this._closed=!0},a.prototype.setContext=function(a){var b=this._win;Object.keys(a).forEach(function(c){b[c]=a[c]})},a.prototype.getContext=function(){var a={},b=this._originalKeys,c=this._win;return Object.keys(c).forEach(function(d){-1===b.indexOf(d)&&(a[d]=c[d])}),a},a.prototype.run=function(a){if(this._closed)throw new Error("cannot run in closed sandbox");return this._win.eval(a)},a});