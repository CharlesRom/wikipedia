{
  "version": "2.9.6",
  "grid": {
    "xWidth": 10,
    "yHeight": 10,
    "layers": {
      "Default layer": {
        "name": "Default layer"
      }
    }
  },
  "modules": [
    {
      "url": "modules/types/science/chemistry/jsme/",
      "id": 1,
      "title": "Draw a structure",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "prefs": [
                [
                  "oldlook"
                ]
              ],
              "labelsize": [
                14
              ],
              "bondwidth": [
                1
              ],
              "highlightColor": [
                "3"
              ],
              "outputResult": [
                []
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "zIndex": 0,
          "display": true,
          "title": "Draw a structure",
          "wrapper": true,
          "created": true,
          "name": "Default layer",
          "position": {
            "left": 0,
            "top": 0
          },
          "size": {
            "width": 50,
            "height": 41
          },
          "bgColor": [
            255,
            255,
            255,
            0
          ]
        }
      },
      "vars_in": [
        {
          "rel": "mol",
          "name": "selectedMol"
        }
      ],
      "actions_in": [
        {}
      ],
      "vars_out": [
        {
          "event": "onStructureChange",
          "rel": "mol",
          "jpath": [],
          "filter": "src/searchFilter.js",
          "name": "query"
        }
      ],
      "actions_out": {},
      "zindex": 3
    },
    {
      "url": "modules/types/edition/onde/",
      "id": 2,
      "title": "Untitled",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "hasButton": [
                []
              ],
              "button_text": [
                "Export"
              ],
              "debouncing": [
                0
              ],
              "output": [
                "new"
              ],
              "mode": [
                "schema"
              ],
              "schemaSource": [
                "config"
              ],
              "schema": [
                "{\n    \"type\": \"object\",\n    \"properties\": {\n        \"searchMode\": {\n            \"type\": \"string\",\n            \"label\": \"Search mode\",\n            \"enum\": [\"Substructure\", \"Exact structure\", \"Similarity\"],\n            \"default\": \"Substructure\",\n            \"required\": true\n        }\n    }\n}"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "zIndex": 0,
          "display": true,
          "title": "Untitled",
          "wrapper": false,
          "created": true,
          "name": "Default layer",
          "position": {
            "left": 2,
            "top": 42
          },
          "size": {
            "width": 35,
            "height": 6
          },
          "bgColor": [
            255,
            255,
            255,
            0
          ]
        }
      },
      "vars_in": [
        {
          "rel": "inputValue",
          "name": "customQueryOpts"
        }
      ],
      "actions_in": {},
      "vars_out": [
        {
          "event": "onFormSubmit",
          "rel": "outputValue",
          "jpath": [],
          "filter": "src/searchFilter.js",
          "name": "queryOptions"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 3
    },
    {
      "url": "modules/types/edition/filter_editor/",
      "id": 3,
      "title": "Untitled",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "script": [
                "var molfile = API.getData('query');\nvar options = API.getData('queryOptions');\nvar molecules = API.getData('molecules');\n\nvar result = [];\n\nif (!molfile || !molfile.get() || !options || !molecules) {\n    for(var i = 0, ii = molecules.length; i < ii; i++) {\n        result.push(molecules[i]);\n    }\n    return API.createData('searchResult', result);\n}\n\nvar queryMol = ACT.Molecule.fromMolfile(molfile.get());\nvar mode = String(options.get('searchMode'));\n\nswitch(mode) {\n    case 'Exact structure': {\n        var idcode = queryMol.getIDCode();\n        for (var i = 0, ii = molecules.length; i < ii; i++) {\n            if(String(molecules[i].actID.value) === idcode) {\n                result = [molecules[i]];\n                break;\n            }\n        }\n        break;\n    }\n    case 'Substructure': {\n        queryMol.setFragment(true);\n        var queryIndex = queryMol.index;\n        var searcher = new ACT.SSSearchWithIndex();\n        searcher.setFragment(queryMol, queryIndex);\n        var db = API.cache('db');\n        for(var i = 0, ii = db.length; i < ii; i++) {\n            var actmol = db[i].molecule,\n                mol = molecules[db[i].index];\n            searcher.setMolecule(actmol, mol.act_idx);\n            if(searcher.isFragmentInMolecule()) {\n                result.push(mol);\n            }\n        }\n        result.sort(function(a,b) {return a.mw-b.mw;})\n        \n        break;\n    }\n    case 'Similarity': {\n        var index = queryMol.getIndex();\n        var targetMW=queryMol.getMolecularFormula().getRelativeWeight();\n        var intermediate = [];\n        for (var i = 0, ii = molecules.length; i < ii; i++) {\n            var similarity=ACT.SSSearchWithIndex.getTanimotoSimilarity(index, molecules[i].act_idx)*100000-Math.abs(targetMW-molecules[i].mw)/1000;\n            intermediate.push([molecules[i],similarity]);\n        }\n        intermediate.sort(function(a,b) {\n            return b[1] - a[1];\n        });\n        for (var i = 0, ii = intermediate.length; i < ii; i++) {\n            result.push(intermediate[i][0]);\n        }\n        break;\n    }\n}\n\n// if there is some result we get the wikipedia article if the first article changed !\n\nif (result.length>0) {\n    var oldLink=\"\";\n    if (API.getData(\"link\")) {\n        var oldLink=API.getData('link')+\"\";\n    }\n    var newLink=result[0].link+\"\";\n    if (oldLink!=newLink) {\n        API.createData('link', result[0].link);\n    }\n}\n\n\n\nAPI.createData('searchResult', result);\nAPI.setVar('hover', ['searchResult', 0]);"
              ]
            }
          ],
          "libs": [
            [
              {
                "lib": "http://www.lactame.com/lib/actelion/2.0.0/actelion.js",
                "alias": "ACT"
              }
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "zIndex": 0,
          "display": false,
          "title": "Untitled",
          "wrapper": true,
          "created": true,
          "name": "Default layer",
          "position": {
            "left": 58,
            "top": 0
          },
          "size": {
            "width": 118,
            "height": 104
          },
          "bgColor": [
            255,
            255,
            255,
            0
          ]
        }
      },
      "vars_in": [
        {
          "rel": "dataobject",
          "name": "query"
        },
        {
          "rel": "dataobject",
          "name": "queryOptions"
        }
      ],
      "actions_in": [
        {}
      ],
      "vars_out": [
        {
          "jpath": []
        }
      ],
      "actions_out": {},
      "zindex": 3
    },
    {
      "url": "modules/types/edition/slick_grid/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "toggle": [
                null
              ],
              "colorjpath": [
                []
              ],
              "slickCheck": [
                [
                  "rowNumbering",
                  "forceFitColumns"
                ]
              ],
              "slick.defaultColumnWidth": [
                null
              ],
              "slick.rowHeight": [
                "150"
              ],
              "slick.selectionModel": [
                [
                  "cell"
                ]
              ],
              "filterRow": [
                null
              ]
            }
          ],
          "cols": [
            [
              {
                "name": "Structure",
                "jpath": [
                  "actID"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 250,
                "minWidth": "250",
                "maxWidth": "250",
                "selectable": [
                  "yes"
                ],
                "resizable": [
                  "yes"
                ],
                "sortable": [
                  "yes"
                ],
                "focusable": [
                  "yes"
                ],
                "defaultSortAsc": [
                  "yes"
                ]
              },
              {
                "name": "Name",
                "jpath": [
                  "name"
                ],
                "editor": "none",
                "formatter": "typerenderer",
                "width": 80,
                "selectable": [
                  "yes"
                ],
                "resizable": [
                  "yes"
                ],
                "sortable": [
                  "yes"
                ],
                "focusable": [
                  "yes"
                ],
                "defaultSortAsc": [
                  "yes"
                ]
              }
            ]
          ],
          "groupings": [
            [
              {}
            ]
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 0,
            "top": 46
          },
          "size": {
            "width": 50,
            "height": 46
          },
          "zIndex": 0,
          "display": true,
          "title": "Click on a line to see wikipedia article",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 4,
      "vars_in": [
        {
          "rel": "list",
          "name": "searchResult"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Click on a line to see wikipedia article",
      "vars_out": [
        {
          "event": "onHover",
          "rel": "row",
          "jpath": [],
          "name": "hover"
        },
        {
          "event": "onSelect",
          "rel": "row",
          "jpath": [
            "link"
          ],
          "name": "link"
        }
      ],
      "actions_out": [
        {
          "jpath": []
        }
      ],
      "zindex": 3
    },
    {
      "url": "modules/types/display/template-twig/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "template": [
                "<center><h1>{{hover.name}}</h1></center>\n<div style=\"height:150px;\"><center>{{rendertype(hover.actID)}}</center></div>\n<table>\n    <tr>\n        <th>MF</th>\n        <td><div style=\"height:20px;\">{{rendertype(hover.mf)}}</div></td>\n    </tr>\n    <tr>\n        <th>mw</th>\n        <td>{{hover.mw|number_format(2)}}</td>\n    </tr>\n</table>"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 51,
            "top": 0
          },
          "size": {
            "width": 96,
            "height": 27
          },
          "zIndex": 0,
          "display": true,
          "title": "Information",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 5,
      "vars_in": [
        {
          "rel": "value",
          "name": "hover"
        }
      ],
      "actions_in": [
        {}
      ],
      "title": "Information",
      "vars_out": {},
      "actions_out": {},
      "zindex": 1
    },
    {
      "url": "modules/types/client_interaction/button_action/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "label": [
                "Search similar molecules"
              ],
              "text": [
                null
              ],
              "toggle": [
                "click"
              ],
              "askConfirm": [
                []
              ],
              "confirmText": [
                "Are you sure?"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 92,
            "top": 21
          },
          "size": {
            "width": 23,
            "height": 9
          },
          "zIndex": 0,
          "display": true,
          "title": "Untitled",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 6,
      "vars_in": [],
      "actions_in": [
        {}
      ],
      "title": "Untitled",
      "vars_out": {},
      "actions_out": [
        {
          "event": "onClick",
          "rel": "actionText",
          "jpath": [],
          "name": "putMol"
        }
      ],
      "zindex": 3
    },
    {
      "url": "modules/types/client_interaction/button_action/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "label": [
                "View in wikipedia"
              ],
              "text": [
                null
              ],
              "toggle": [
                "click"
              ],
              "askConfirm": [
                []
              ],
              "confirmText": [
                "Are you sure?"
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 77,
            "top": 21
          },
          "size": {
            "width": 29,
            "height": 12
          },
          "zIndex": 0,
          "display": true,
          "title": "Untitled",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": false,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 7,
      "vars_in": [],
      "actions_in": [
        {}
      ],
      "title": "Untitled",
      "vars_out": {},
      "actions_out": [
        {
          "event": "onClick",
          "rel": "actionText",
          "jpath": [],
          "name": "viewDrug"
        }
      ],
      "zindex": 2
    },
    {
      "url": "modules/types/display/iframe/",
      "configuration": {
        "sections": {},
        "groups": {
          "group": [
            {
              "colnumber": [
                5
              ],
              "valjPath": [
                null
              ],
              "colorjPath": [
                null
              ],
              "width": [
                null
              ],
              "height": [
                null
              ]
            }
          ]
        }
      },
      "layers": {
        "Default layer": {
          "position": {
            "left": 51,
            "top": 28
          },
          "size": {
            "width": 96,
            "height": 64
          },
          "zIndex": 0,
          "display": true,
          "title": "Wikipedia article",
          "bgColor": [
            255,
            255,
            255,
            0
          ],
          "wrapper": true,
          "created": true,
          "name": "Default layer"
        }
      },
      "id": 8,
      "vars_in": [
        {
          "rel": "url",
          "name": "link"
        }
      ],
      "actions_in": {},
      "title": "Wikipedia article",
      "vars_out": {},
      "actions_out": {}
    }
  ],
  "variables": [
    {
      "varname": "molecules",
      "jpath": [
        "molecules"
      ]
    },
    {
      "varname": "queryOptions",
      "jpath": [
        "queryOptions"
      ]
    },
    {
      "varname": "query",
      "jpath": [
        "query"
      ]
    }
  ],
  "pouchvariables": [
    {}
  ],
  "configuration": {
    "title": "Search wikipedia by substructure and similarity"
  },
  "actionscripts": [
    {
      "sections": {},
      "groups": {
        "action": [
          {
            "name": [
              null
            ],
            "script": [
              null
            ]
          }
        ]
      }
    }
  ],
  "crons": [
    {}
  ],
  "couch_replication": [
    {
      "sections": {},
      "groups": {
        "couch": [
          [
            {
              "direction": "both",
              "continuous": []
            }
          ]
        ]
      }
    }
  ],
  "init_script": [
    {
      "sections": {},
      "groups": {
        "general": [
          {
            "script": [
              "require(['../../src/init']);"
            ]
          }
        ]
      }
    }
  ],
  "custom_filters": [
    {
      "sections": {
        "filters": [
          {
            "sections": {},
            "groups": {
              "filter": [
                {
                  "name": [
                    null
                  ],
                  "script": [
                    null
                  ]
                }
              ],
              "libs": [
                [
                  {}
                ]
              ]
            }
          }
        ]
      },
      "groups": {}
    }
  ],
  "actionfiles": [
    {
      "sections": {},
      "groups": {
        "action": [
          [
            {
              "name": "putMol",
              "file": "../../../../src/putMol",
              "mode": "amd"
            },
            {
              "name": "viewDrug",
              "file": "../../../../src/viewDrug",
              "mode": "amd"
            }
          ]
        ]
      }
    }
  ]
}